<!DOCTYPE html>
<html lang="en">

<head>
  <script>
    // Check if a success message is provided and display it as a popup
    var successMessage = "{{ success_message }}";
    if (successMessage && successMessage !== 'None') {
      alert(successMessage);  // You can use a more sophisticated popup library here if needed
    }
  </script>

  {% include 'metaData.html' %}

  <!-- BEGIN PAGE LEVEL PLUGINS/CUSTOM STYLES -->

  <style>
    /* date picker start */

    /* Style the input box */
    .form-control-sm {
      width: 200px;
      /* Set your desired width */

      font-size: 14px;
      border: 1px solid #ccc !important;
      border-radius: 4px;
      background-color: rgb(251, 255, 254);
    }

    .form-control {
      border: 1px solid #ccc !important;
    }

    .form-control:hover {
      border: 1px solid #ccc !important;
    }

    tr:not(:first-child):hover {
      transform: none !important;
    }

    .input-group-text {

      padding: 0px 0.75rem;
      font-size: 0.9rem;
    }

    /* Style the placeholder text */
    ::placeholder {
      color: #999;
      /* Customize the placeholder color */
    }

    /* date picker ends*/

    .text-primary {
      color: #00579c !important;
    }

    .form-control-sm:hover {
      border: 1px solid #ced4da !important;
    }

    .btn-primary {
      background-color: #00579c !important;
      border-color: #00579c !important;
    }

    .btn-danger {
      background-color: #df2233 !important;
    }

    .page-item.active .page-link {
      background-color: #00579c !important;
    }

    .layout-px-spacing {
      min-height: calc(100vh - 166px) !important;
    }

    .paths:hover {
      text-decoration: underline;
    }

    #select-all {
      cursor: pointer;
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      width: 20px;
      height: 20px;
      background-color: #ffffff;
      border-radius: 50%;
      display: inline-block;
      vertical-align: middle;
    }

    .checkbox {
      cursor: pointer;
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      width: 20px;
      height: 20px;
      background-color: #8080805b;
      border-radius: 50%;
      display: inline-block;
      vertical-align: middle;
    }

    .checkbox:checked {
      border: 2px solid rgb(0, 119, 255);
      background: url('../static/assets/img/tick-svgrepo-com.png');
      background-size: 100% 100%;
      /* Make sure the image covers the entire checkbox */
    }

    .checkbox:active {
      border: 2px solid rgb(0, 119, 255);

      background: url('../static/assets/img/tick-svgrepo-com.png');
      /* Set the background image when the checkbox is clicked */
      background-size: 100% 100%;
      /* Make sure the image covers the entire checkbox */
    }

    tr {
      transition: all 0.1s ease-in-out;
    }

    tr:not(:first-child):hover {
      transform: scale(1.01);
    }

    th:first-child::after {
      content: "" !important;
    }

    th:first-child::before {
      content: "" !important;
    }

    td,
    th {
      padding: 8px 15px !important;
      border: none !important;
      border-bottom: 2px solid #00000033 !important;
      text-align: left !important;
    }

    /* .modal-content {} */
  </style>

  <!-- END PAGE LEVEL PLUGINS/CUSTOM STYLES -->
</head>

<body>
  <!-- BEGIN LOADER -->
  <div id="load_screen">
    <div class="loader">
      <div class="loader-content">
        <div class="spinner-grow align-self-center"></div>
      </div>
    </div>
  </div>
  <!--  END LOADER -->

  <!--  BEGIN NAVBAR  -->
  {% include 'header.html' %}

  <!--  END NAVBAR  -->

  <!--  BEGIN NAVBAR  -->
  <div class="sub-header-container">
    <header class="header navbar navbar-expand-sm">
      <a href="javascript:void(0);" class="sidebarCollapse" data-placement="bottom"><svg
          xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
          class="feather feather-menu">
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </a>

      <ul class="navbar-nav flex-row" style="gap: 10px;">

        <li>
          <div class="page-header">
            <div class="page-title">
              <nav class="breadcrumb-one" aria-label="breadcrumb">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item"><a href="{{ url_for(dashBoardType) }}" class="text-blue font-weight-bold">
                      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                        class="feather feather-home">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        <polyline points="9 22 9 12 15 12 15 22"></polyline>
                      </svg>
                    </a></li>
                </ol>
              </nav>
            </div>
          </div>
        </li>
        <li>
          <a href="{{ url_for( type ) }}" class="text-blue">/ <span class="paths ">Archive's</span></a>

        </li>

      </ul>
    </header>
  </div>
  <!--  END NAVBAR  -->



  <!--  BEGIN CONTENT PART  -->
  <!--  BEGIN MAIN CONTAINER  -->
  <div class="main-container" id="container">

    <div class="overlay"></div>
    <div class="search-overlay"></div>

    <!--  BEGIN SIDEBAR  -->
    {% include 'sidebar.html' %}

    <!--  END SIDEBAR  -->

    <!--  BEGIN CONTENT AREA  -->
    <div id="content" class="main-content">
      <div class="layout-px-spacing">

        <div class="alert alert-success position-relative" role="alert" style="right: 0; top: 1%;display: none;"
          id="sucessAlert">
          Successfully Submited...
        </div>
        <div class=" layout-top-spacing">





          <!-- <div id="content" class="main-content">
                                          <div class="layout-px-spacing"> -->

          <div class="row layout-top-spacing layout-spacing">
            <div class="col-lg-12 ">
              <div class="statbox widget box box-shadow">

                <div class="border rounded  shadow-sm">
                  <div class="row m-1 justify-content-center">
                    <div class="col-lg-4 mt-3">
                      <div class="btn-group submitter-group ">
                        <div class="input-group-prepend">
                          <div class="input-group-text">Customer No</div>
                        </div>
                        <input type="text" class="filter-checkbox  form-control-sm" id="custId"
                          placeholder="Enter Customer No..." />
                      </div>
                    </div>
                    <div class="col-lg-4 mt-3">
                      <div class="btn-group submitter-group">
                        <div class="input-group-prepend">
                          <div class="input-group-text">
                            MIN Violated Amount
                          </div>
                        </div>
                        <input type="number" class="filter-checkbox form-control-sm" id="minViolatedAmount"
                          placeholder="Enter min Violated Amount..." />
                      </div>
                      <h5 class="text-center m-3">To</h5>
                      <div class="btn-group submitter-group">
                        <div class="input-group-prepend">
                          <div class="input-group-text">
                            MAX Violated Amount
                          </div>
                        </div>
                        <input type="number" class="filter-checkbox form-control-sm" id="maxViolatedAmount"
                          placeholder="Enter max Violated Amount..." />
                      </div>
                    </div>


                    <div class="col-lg-4 text-left mt-4">
                      <div class="btn-group submitter-group ">
                        <div class="input-group-prepend">
                          <div class="input-group-text">Account Number</div>
                        </div>
                        <input type="text" class="filter-checkbox form-control-sm" id="AccountNumber"
                          placeholder="Enter Account Number..." />

                      </div>
                    </div>
                    <div class="row m-1 justify-content-start">
                      <div class="col-lg-4 mt-3">
                        <div class="btn-group ">
                          <div class="input-group-prepend">
                            <div class="input-group-text">Scenario</div>
                          </div>
                          <select class="form-control-sm" id="Scenario">
                            <option value="">Scenario</option>
                            <option value="AM">AM</option>
                            <option value="ADB">ADB</option>
                            <option value="CDD">CDD</option>
                            <option value="LOM">LOM</option>
                            <option value="NCM">NCM</option>
                            <option value="SCI">SCI</option>
                            <option value="TF">TF</option>
                            <option value="TBML">TBML</option>
                            <option value="TDD">TDD</option>
                            <option value="FICN">FICN</option>
                            <option value="MICN">MICN</option>
                            <option value="ODI">ODI</option>
                          </select>
                        </div>
                      </div>

                      <div class="col-lg-6 mt-3 ">
                        <div class="btn-group submitter-group ">
                          <div class="input-group-prepend">
                            <div class="input-group-text">Date</div>
                          </div>
                          <input id="rangeCalendarFlatpickr" class="form-control-sm flatpickr flatpickr-input active"
                            type="text" style="background-color: transparent !important;"
                            placeholder="Select Date Range.." />
                        </div>
                      </div>
                    </div>


                  </div>
                  <div class="col-12 text-center mt-1 mb-2">
                    <button id="filter-button" class="btn btn-sm btn-blue mt-3">Apply Filters</button>
                  </div>
                </div>

                <div class="row pt-4">
                  <!-- <div class="col-12 text-left">
                    <button type="button" onclick="downloadAll()" class="btn btn-sm btn-blue" style="
                          width: 70px;
                          height: 30px;
                          padding: 0;
                          float: right;
                        ">
                      <svg viewBox="0 0 24 24" width="24" height="24" fill="#ffff" xmlns="http://www.w3.org/2000/svg">
                        <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                        <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                        <g id="SVGRepo_iconCarrier">
                          <path
                            d="M12.5535 16.5061C12.4114 16.6615 12.2106 16.75 12 16.75C11.7894 16.75 11.5886 16.6615 11.4465 16.5061L7.44648 12.1311C7.16698 11.8254 7.18822 11.351 7.49392 11.0715C7.79963 10.792 8.27402 10.8132 8.55352 11.1189L11.25 14.0682V3C11.25 2.58579 11.5858 2.25 12 2.25C12.4142 2.25 12.75 2.58579 12.75 3V14.0682L15.4465 11.1189C15.726 10.8132 16.2004 10.792 16.5061 11.0715C16.8118 11.351 16.833 11.8254 16.5535 12.1311L12.5535 16.5061Z"
                            fill="#ffff"></path>
                          <path
                            d="M3.75 15C3.75 14.5858 3.41422 14.25 3 14.25C2.58579 14.25 2.25 14.5858 2.25 15V15.0549C2.24998 16.4225 2.24996 17.5248 2.36652 18.3918C2.48754 19.2919 2.74643 20.0497 3.34835 20.6516C3.95027 21.2536 4.70814 21.5125 5.60825 21.6335C6.47522 21.75 7.57754 21.75 8.94513 21.75H15.0549C16.4225 21.75 17.5248 21.75 18.3918 21.6335C19.2919 21.5125 20.0497 21.2536 20.6517 20.6516C21.2536 20.0497 21.5125 19.2919 21.6335 18.3918C21.75 17.5248 21.75 16.4225 21.75 15.0549V15C21.75 14.5858 21.4142 14.25 21 14.25C20.5858 14.25 20.25 14.5858 20.25 15C20.25 16.4354 20.2484 17.4365 20.1469 18.1919C20.0482 18.9257 19.8678 19.3142 19.591 19.591C19.3142 19.8678 18.9257 20.0482 18.1919 20.1469C17.4365 20.2484 16.4354 20.25 15 20.25H9C7.56459 20.25 6.56347 20.2484 5.80812 20.1469C5.07435 20.0482 4.68577 19.8678 4.40901 19.591C4.13225 19.3142 3.9518 18.9257 3.85315 18.1919C3.75159 17.4365 3.75 16.4354 3.75 15Z"
                            fill="#ffff"></path>
                        </g>
                      </svg>
                    </button>
                  </div> -->
                </div>



                <!-- <div class="form-group mb-0 widget-content widget-content-area pb-0 "
                style="display: flex;justify-content: end;align-items: center;gap: 10px;">
                <label style="font-size:20px;font-weight:500;color: #8e949d;text-wrap: nowrap;" class="mt-2">Date : </label>
                <input id="rangeCalendarFlatpickr" class="form-control flatpickr flatpickr-input active" type="text" style="background-color: transparent !important;"
                  placeholder="Select Date Range.." />
              </div> -->
                <div class="widget-content widget-content-area">
                  <div class="table-responsive mb-4 ">

                    <section>

                      <table id="example" class="display nowrap" style="width: 100%">
                        <thead>
                          <tr>
                            <th>
                              <input type="checkbox" disabled id="select-all" class="checkbox" />
                            </th>

                            <th>Account Number</th>
                            <th>Customer No</th>
                            <th>scenario</th>
                            <th>Date</th>
                            <th>Risk Rating</th>
                            <th>Amount</th>

                            <th>Edit</th>



                          </tr>
                        </thead>
                        <tbody id="tableBody">

                          {% for document in data %}
                          <tr>

                            <td></td>

                            <td>{{ document.AccountNumber }}</td>
                            <td>
                              <form action="{{ url_for('acc_holder_offline_history') }}" method="post">
                                <input type="text" name="accnum" value="{{document.AccountNumber}}"
                                  style="display: none" />
                                <input type="text" name="txdate" value="{{document.TransactionDate}}"
                                  style="display: none" />
                                <input type="text" name="custid" value="{{document.Customerno}}"
                                  style="display: none" />
                                <input type="hidden" name="ticket_id" value="{{ document.ticket_id }}" />
                                <button type="submit" style="border: none">
                                  {{document.Customerno}}
                                </button>
                              </form>
                            </td>
                            <td>{{ document.scenario }}</td>
                            <td>{{ document.Created_Date}}</td>
                            <td>{{ document.RiskRating }}</td>
                            <td>{{ document.amount }}</td>


                            <td class="pl-5 ml-5">
                              <form action="{{url_for('offline_Form_Edit', account_number=document.ticket_id)}}"
                                method="post">
                                <input type="text" name="ticket_id" class="d-none" value="{{ document.ticket_id }}">
                                <button type="submit" class="btn btn-sm btn-blue"
                                  style="width: 30px; height: 30px; padding: 0">
                                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                    fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                    stroke-linejoin="round" class="feather feather-file-plus">
                                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                                    <polyline points="14 2 14 8 20 8"></polyline>
                                    <line x1="12" y1="18" x2="12" y2="12"></line>
                                    <line x1="9" y1="15" x2="15" y2="15"></line>
                                  </svg>
                                </button>
                              </form>
                            </td>

                          </tr>


                          {% endfor %}
                          <!-- Add more rows with your own data as needed -->
                        </tbody>

                      </table>

                    </section>






                  </div>
                </div>
              </div>
            </div>
          </div>
          {% include 'footer.html' %}

        </div>
      </div>
      <!-- END MAIN CONTAINER -->



      <!-- BEGIN GLOBAL MANDATORY SCRIPTS -->
      <script src="../static/assets/js/libs/jquery-3.1.1.min.js"></script>
      <script src="../static/bootstrap/js/popper.min.js"></script>
      <script src="../static/bootstrap/js/bootstrap.min.js"></script>
      <script src="../static/plugins/perfect-scrollbar/perfect-scrollbar.min.js"></script>
      <script src="../static/assets/js/app.js"></script>

      <!-- viwe JS start -->

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.5.0/dist/js/bootstrap.min.js"></script>


      <!-- viwe JS ends -->


      <script type="text/javascript" language="javascript"
        src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
      <script type="text/javascript" language="javascript"
        src="https://cdn.datatables.net/1.10.7/js/jquery.dataTables.min.js"></script>
      <script>
        $(document).ready(function () {
          App.init();
        });


      </script>
      <script src="../static/assets/js/custom.js"></script>
      <!-- END GLOBAL MANDATORY SCRIPTS -->

      <!-- BEGIN PAGE LEVEL PLUGINS/CUSTOM SCRIPTS -->
      <script src="../static/plugins/apex/apexcharts.min.js"></script>

      <script src="../static/assets/js/dashboard/dash_1.js"></script>

      <!-- <script src="../static/assets/js/tables.js/tableCheckBox.js"></script> -->
      <!-- BEGIN PAGE LEVEL PLUGINS/CUSTOM SCRIPTS -->

      <script src="../static/plugins/table/datatable/datatables.js"></script>
      <script type="text/javascript" language="javascript"
        src="https://cdn.datatables.net/responsive/2.3.0/js/dataTables.responsive.min.js"></script>

      <script>
        document.addEventListener("DOMContentLoaded", function () {
          var dataTable = $("#example").DataTable({
            rowReorder: {
              selector: "td:nth-child(2)",
            },
            responsive: true,
            paging: true,
            scrollY: "300px",
            scrollCollapse: true,
            scrollInfinite: true,
            info: true,
          });

          var flatpickrInstance = datePicker();

          $("#filter-button").on("click", function () {
            applyFilters();
          });

          function datePicker() {
            var dateRangeInput = document.getElementById('rangeCalendarFlatpickr');
            return flatpickr(dateRangeInput, {
              mode: "range",
            });
          }

          // Bind applyFilters function to button click
          $("#filter-button").on("click", function () {
            applyFilters();
            var minViolatedAmount = document.getElementById("minViolatedAmount").value;
            var maxViolatedAmount = document.getElementById("maxViolatedAmount").value;
            var selectedDates = flatpickrInstance.selectedDates;
            if (selectedDates.length === 2) {
              var startDate = selectedDates[0];
              var endDate = selectedDates[1];
              // var dece = filterTableByDateRange(startDate, endDate);

              if (minViolatedAmount.length != 0 && maxViolatedAmount.length != 0) {
                filterTableByViolationAmounts(minViolatedAmount, maxViolatedAmount);
              }
            } else if (minViolatedAmount.length != 0 && maxViolatedAmount.length != 0) {
              filterTableByViolationAmounts(minViolatedAmount, maxViolatedAmount);
            } else {
              // Handle the case where the date range is not selected
              console.log("Please select a date range");
              var table = document.getElementById("tableBody");
              var rows = table.getElementsByTagName("tr");
              // Show all rows when the date range is empty
              for (var i = 0; i < rows.length; i++) {
                rows[i].style.display = "";
              }
              return; // Exit the function when the date range is empty
            }
          });

          function applyFilters() {
            var custId = $('#custId').val();
            var accountNumber = $('#AccountNumber').val();
            var scenario = $('#Scenario').val();
            var selectedDates = flatpickrInstance.selectedDates;
            var startDate = selectedDates ? selectedDates[0] : null;
            var endDate = selectedDates ? selectedDates[1] : null;

            dataTable.columns().search('');

            if (custId) {
              dataTable.column(2).search(custId); // Corrected the index to match the "Customer No" column
            }
            if (accountNumber) {
              dataTable.column(1).search(accountNumber); // Corrected the index to match the "Account Number" column
            }
            if (scenario) {
              dataTable.column(3).search(scenario); // Corrected the index to match the "scenario" column
            }
            if (startDate && endDate) {
              filterTableByDateRange(startDate, endDate);
            }

            dataTable.draw();
          }

          function filterTableByDateRange(startDate, endDate) {
            var table = $("#example").DataTable();

            table.rows().every(function () {
              var row = this.node();
              var dateCell = this.data()[4]; // Corrected the index to match the "Date" column

              if (dateCell) {
                var rowDate = new Date(dateCell);
                rowDate.setHours(0, 0, 0, 0);

                if (rowDate >= startDate && rowDate <= endDate) {
                  row.style.display = "";
                } else {
                  row.style.display = "none";
                }
              }
            });

            table.draw();
          }

          function filterTableByViolationAmounts(minViolatedAmount, maxViolatedAmount) {
            var table = $("#example").DataTable();
            var rows = table.rows().nodes(); // Get all table rows

            // Iterate over each row
            $(rows).each(function () {
              var row = $(this);
              var amountCell = row.find("td:eq(6)").text().trim(); // Get text content of the 7th column (Amount)

              if (amountCell !== "") {
                // Convert the amount cell value to string for comparison
                var amount = amountCell.toString();

                // Check if the amount is within the provided range
                if (amount >= minViolatedAmount && amount <= maxViolatedAmount) {
                  row.show(); // Display the row if it matches the filter criteria
                } else {
                  row.hide(); // Hide the row if it doesn't match the filter criteria
                }
              }
            });
          }

          function submitForm() {
            var form = event.target.closest("form");
            form.submit();
          }
        });

      </script>


      <script>
        function downloadAll() {
          // Manually construct JSON object from dgmuser array
          var data = [
            {% for document in data %}
        {
          "ticket_id": "{{ document.ticket_id }}",
            "Created_Date": "{{ document.Created_Date }}",
              "Customerno": "{{ document.Customerno }}",
                "casename": "{{ document.casename }}",
                  "scenario": "{{ document.scenario }}",
                    "Guidance": "{{ document.Guidance }}",
                      "RuleScenario": "{{ document.RuleScenario }}",
                        "personname": "{{ document.personname }}",
                          "SourceofAlert": "{{ document.SourceofAlert }}",
                            "alertindicator": "{{ document.alertindicator }}",
                              "SuspiciousDueToproceedofCrime": "{{ document.SuspiciousDueToproceedofCrime }}",
                                "SuspiciousDueToComplexTranscaction": "{{ document.SuspiciousDueToComplexTranscaction }}",
                                  "SuspiciousDueToNoecoRational": "{{ document.SuspiciousDueToNoecoRational }}",
                                    "SuspiciousDueToFinancingTerrorism": "{{ document.SuspiciousDueToFinancingTerrorism }}",
                                      "AttemptedTranscaction": "{{ document.AttemptedTranscaction }}",
                                        "LEAInformed": "{{ document.LEAInformed }}",
                                          "PriorityRating": "{{ document.PriorityRating }}",
                                            "ReportCoverage": "{{ document.ReportCoverage }}",
                                              "leadetails": "{{ document.leadetails }}",
                                                "AdditionalDocument": "{{ document.AdditionalDocument }}",
                                                  "Aroundofsuspision": "{{ document.Aroundofsuspision }}",
                                                    "DetailsofInvestigation": "{{ document.DetailsofInvestigation }}",
                                                      "AccountNumber": "{{ document.AccountNumber }}",
                                                        "AccountType": "{{ document.AccountType }}",
                                                          "holdername": "{{ document.holdername }}",
                                                            "AccountHolderType": "{{ document.AccountHolderType }}",
                                                              "AccountStatus": "{{ document.AccountStatus }}",
                                                                "DateofOpening": "{{ document.DateofOpening }}",
                                                                  "RiskRating": "{{ document.RiskRating }}",
                                                                    "CummulativeCerditTurnover": "{{ document.CummulativeCerditTurnover }}",
                                                                      "CummulativeDebitTurnover": "{{ document.CummulativeDebitTurnover }}",
                                                                        "CummulativeCashDepositTurnover": "{{ document.CummulativeCashDepositTurnover }}",
                                                                          "CummulativeCashWithdrawalTurnover": "{{ document.CummulativeCashWithdrawalTurnover }}",
                                                                            "NoOfTransactionsToBeReported": "{{ document.NoOfTransactionsToBeReported }}",
                                                                              "TransactionDate": "{{ document.TransactionDate }}",
                                                                                "TransactionsID": "{{ document.TransactionsID }}",
                                                                                  "TransactionMode": "{{ document.TransactionMode }}",
                                                                                    "DebitCredit": "{{ document.DebitCredit }}",
                                                                                      "amount": "{{ document.amount }}",
                                                                                        "TransactionsCurrency": "{{ document.TransactionsCurrency }}",
                                                                                          "ProductType": "{{ document.ProductType }}",
                                                                                            "ProductIdentifiers": "{{ document.ProductIdentifiers }}",
                                                                                              "TransactionType": "{{ document.TransactionType }}",
                                                                                                "unit": "{{ document.unit }}",
                                                                                                  "Date": "{{ document.Date }}",
                                                                                                    "DispositionOfFunds": "{{ document.DispositionOfFunds }}",
                                                                                                      "RelatedAccountNumber": "{{ document.RelatedAccountNumber }}",
                                                                                                        "RelatedInstitutionName": "{{ document.RelatedInstitutionName }}",
                                                                                                          "RelatedInstitutionRefNum": "{{ document.RelatedInstitutionRefNum }}",
                                                                                                            "Remark": "{{ document.Remark }}",
                                                                                                              "ROS_cmt": "{{ document.ROS_cmt }}",
                                                                                                                "Created_By": "{{ document.Created_By }}",
                                                                                                                  "DGM_cmt": "{{ document.DGM_cmt }}"
        } {% if not loop.last %}, {% endif %}
        {% endfor %}
              ];

        // Send the constructed JSON object in the fetch request
        if (data.length > 0) {
          fetch('/offlineactiveCases', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify({
              tickets: data
            })
          })
            .then(response => {
              if (!response.ok) {
                throw new Error('Network response was not ok');
              }
              return response.blob();
            })
            .then(blob => {
              const url = window.URL.createObjectURL(blob);

              const link = document.createElement('a');
              link.href = url;
              link.setAttribute('download', 'offlinearchivedcases.zip');

              document.body.appendChild(link);
              link.click();
              document.body.removeChild(link);
            })
            .catch(error => {
              console.error('There was an error!', error);
            });
        } else {
          console.error('data is empty');
        }
          }
      </script>

</body>

</html>